<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Deletion Request - Fucci</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background-color: #fff;
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #007AFF;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .intro {
            margin-bottom: 30px;
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .required {
            color: #ff3333;
        }

        input[type="text"],
        input[type="email"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            font-family: inherit;
            box-sizing: border-box;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .submit-btn {
            background-color: #007AFF;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.2s;
        }

        .submit-btn:hover {
            background-color: #0056b3;
        }

        .submit-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
            display: none;
        }

        .loading {
            display: none;
            text-align: center;
            color: #666;
            margin-top: 10px;
        }

        .note {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
    </style>
</head>

<body>
    <h1>Data Deletion Request</h1>

    <p class="intro">
        If you would like to request deletion of your account and associated data, please fill out the form below.
        We will process your request within 30 days as required by applicable data protection laws.
    </p>

    <div class="success-message" id="successMessage">
        Thank you for your request. We have received your data deletion request and will process it within 30 days.
    </div>

    <div class="error-message" id="errorMessage">
        There was an error submitting your request. Please try again or contact us directly.
    </div>

    <form id="deletionForm">
        <div class="form-group">
            <label for="email">
                Email Address <span class="required">*</span>
            </label>
            <input type="email" id="email" name="email" required placeholder="your.email@example.com">
            <p class="note">Please provide the email address associated with your account</p>
        </div>

        <div class="form-group">
            <label for="username">
                Username (Optional)
            </label>
            <input type="text" id="username" name="username" placeholder="Your username">
            <p class="note">If you remember your username, this helps us locate your account faster</p>
        </div>

        <div class="form-group">
            <label for="reason">
                Reason for Deletion <span class="required">*</span>
            </label>
            <textarea id="reason" name="reason" required
                placeholder="Please provide a brief reason for requesting account deletion..."></textarea>
            <p class="note">This helps us improve our service</p>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">
            Submit Deletion Request
        </button>

        <div class="loading" id="loading">
            Submitting your request...
        </div>
    </form>

    <script>
        const form = document.getElementById('deletionForm');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const submitBtn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Hide previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // Disable submit button and show loading
            submitBtn.disabled = true;
            loading.style.display = 'block';

            const formData = {
                email: document.getElementById('email').value.trim(),
                username: document.getElementById('username').value.trim() || null,
                reason: document.getElementById('reason').value.trim()
            };

            try {
                // Get the current origin (works for both local and production)
                const baseUrl = window.location.origin;
                const response = await fetch(`${baseUrl}/data-deletion-request`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    successMessage.style.display = 'block';
                    form.reset();
                    // Scroll to top to show success message
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    throw new Error('Failed to submit request');
                }
            } catch (error) {
                console.error('Error submitting form:', error);
                errorMessage.style.display = 'block';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } finally {
                submitBtn.disabled = false;
                loading.style.display = 'none';
            }
        });
    </script>
</body>

</html>